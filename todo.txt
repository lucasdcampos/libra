TODO:
    - Melhorar trechos suscetíveis a erros (e error handling)
    - Otimizar código
